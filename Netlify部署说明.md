# 🚀 Banana AI - Netlify 部署说明文档

本指南将帮助你将 **Banana AI** 智能图像生成系统部署到 Netlify 平台。由于本项目基于 Vite 开发，我们将采用最简单的“关联 GitHub/GitLab 仓库”方式实现持续集成与自动部署。

---

## 1. 准备工作

在开始部署前，请确保以下事项已完成：
*   项目代码已上传至 GitHub、GitLab 或 Bitbucket。
*   你已拥有一个 [Netlify](https://www.netlify.com/) 账号。
*   确认 `package.json` 中包含正确的构建脚本（本项目已包含 `"build": "vite build"`）。

---

## 2. 部署步骤

### 第一步：新建站点
1.  登录 Netlify 后控制台，点击 **"Add new site"** 按钮。
2.  选择 **"Import an existing project"**。

### 第二步：关联 Git 仓库
1.  选择你的 Git 提供商（如 GitHub）。
2.  在弹出的窗口中授权 Netlify 访问你的仓库。
3.  在搜索框中找到并选择 `banana-two`（或你修改后的项目名）仓库。

### 第三步：配置构建设置
Netlify 通常会自动识别 Vite 项目，请核对以下配置：
*   **Base directory**: (保持为空)
*   **Build command**: `npm run build`
*   **Publish directory**: `dist`

### 第四步：设置环境变量 (关键 🔐)
为了确保 API 调用正常且安全，必须在部署时设置环境变量：
1.  点击 **"Site settings"** -> **"Environment variables"**。
2.  点击 **"Add a variable"** -> **"Import from .env"** 或者手动添加单条变量：
    *   **Key**: `VITE_GRSAI_API_KEY`
    *   **Value**: `你的GRSAI_API密钥` (例如: sk-cb6ce7c67127418e91a... )

> **注意**：Vite 项目的环境变量必须以 `VITE_` 开头，否则在前端代码中无法通过 `import.meta.env` 获取。

### 第五步：部署
1.  配置完成后，点击 **"Deploy site"**。
2.  等待几分钟，Netlify 会自动安装依赖、构建项目并生成一个可公开访问的二级域名。

---

## 3. 进阶配置：解决单页路由或刷新 404 问题

如果你的应用将来增加路由（React Router），请在项目根目录下创建一个 `netlify.toml` 文件或 `public/_redirects` 文件，以处理 SPA（单页应用）的重定向问题。

**方法：创建 `public/_redirects` 文件**
内容如下：
```text
/*    /index.html   200
```

---

## 4. 常见问题排查

*   **API 请求失败 (401 Unauthorized)**：
    *   检查 Netlify 的环境变量 `VITE_GRSAI_API_KEY` 是否拼写正确。
    *   修改环境变量后，需要重新触发构建（Trigger deploy）才能生效。
*   **构建失败 (Build Failed)**：
    *   检查 Node.js 版本。Netlify 默认使用最新的 LTS 版本，如果需要特定版本，可以在项目根目录创建 `.nvmrc` 文件并写入版本号（如 `20`）。
*   **图片生成失败**：
    *   确保你的 API 密钥金额充足，且网络能够访问 `https://grsai.dakka.com.cn`。

---

## 5. 持续集成与更新

一旦部署成功，每次你向 GitHub 的主分支（main/master）提交或推送代码时，Netlify 都会自动启动新的构建任务并更新你的站点，无需手动操作。

---
*Generated by Antigravity AI - 2026-01-02*
